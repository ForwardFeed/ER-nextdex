(()=>{"use strict";let e,t,n;function s(n,s,i,a=!1,c=!0){o();let r=s.clientX,l=s.clientY;e=document.createElement("div"),e.className="window-frame",a&&(e.style.backgroundColor="rgba(0,0,0,0)"),e.append(n),document.body.append(e),t=function(e,t=!1){function n(e,t){return!!e&&(e==t||n(e.parentNode,t))}const s=o=>{n(o.target,e)||(t&&o.stopPropagation(),e.remove(),document.body.removeEventListener("click",s,t))};return document.body.addEventListener("click",s,t),s}(e,c),s.stopPropagation(),"mid"===i&&(r-=parseInt(n.offsetWidth/2),r<0&&(r=0),l-=parseInt(n.offsetHeight/2),l<0&&(l=0)),e.offsetWidth+r>document.body.offsetWidth&&(r=document.body.offsetWidth-e.offsetWidth),e.offsetHeight+l>document.body.offsetHeight&&(l=document.body.offsetHeight-e.offsetHeight),e.style.left=r+"px",e.style.top=l+"px","focus"===i&&$(e).find("input").focus()}function o(n){n&&t&&t(n),e&&e.remove()}let i=0;function a(e){i=e;const t=re.moves[e];$("#moves-name").text(t.name),$("#moves-internal-id").text(`ingame ID: ${t.id}`),$("#moves-pwr").text(t.pwr?1==t.pwr?"?":t.pwr:"--"),$("#moves-acc").text(t.acc),$("#moves-chance").text(t.chance),$("#moves-pp").text(t.pp),$("#moves-prio").text(t.prio),function(e){const t=["foe1","foe2","foe3","ally1","allySelf","ally2"],n={SELECTED:[0,1,0,0,0,0],BOTH:[0,1,0,0,1,0],USER:[0,0,0,0,1,0],RANDOM:[2,2,2,2,0,2],FOES_AND_ALLY:[1,1,1,1,0,1],DEPENDS:[2,2,2,0,0,0],ALL_BATTLERS:[1,1,1,1,1,1],OPPONENTS_FIELD:[1,1,1,0,0,0],ALLY:[0,0,0,1,0,1]}[re.targetT[e]],s=["unset","#f4072a","#c74fef"];for(const e in t){const o=$("#"+t[e]),i=n[e];o.css("background-color",s[i])}}(t.target),$("#moves-split").attr("src",`./icons/${re.splitT[t.split]}.png`),$("#moves-split")[0].dataset.split=re.splitT[t.split].toLowerCase(),function(e){for(let t=0;t<2;t++){const n=re.typeT[e[t]]||"";$(`#moves-types${t+1}`).attr("class",`type ${n.toLowerCase()}`).children().text(n)}}(t.types),$("#moves-desc").text(t.lDesc),c(t.flags.map((e=>re.flagsT[e])),$("#moves-flags")),$("#moves-list").find(".sel-active").addClass("sel-n-active").removeClass("sel-active"),$("#moves-list").children().eq(e-1).addClass("sel-active").removeClass("sel-n-active")}function c(e,t,n=(()=>{})){const s={"Makes Contact":"Has contact and Big Pecks boost","Kings Rock Affected":"Triggers King's rock","High Crit":"High crits chances","Iron Fist Boost":"Iron fist boost","Sheer Force Boost":"Sheer force boost","Keen Edge Boost":"Keen edge boost","Air Based":"Giant wings boost","Snatch Affected":"Can be snatched",Dance:"Dance","Always Crit":"Always Crit","Field Based":"Field Explorer boost","Striker Boost":"Striker boost","Two Strikes":"Hit twice","Reckless Boost":"Reckless boost","Magic Coat Affected":"Affected by magic coat","Horn Based":"Mighty Horn boost","Strong Jaw Boost":"Strong Jaw boost",Sound:"Is a sound move","Mega Launcher Boost":"Mega Launcher Boost",Ballistic:"Is a bullet move","Dmg Underwater":"Damage foes under water","Weather Based":"Changes with the weather",Powder:"Power move","Dmg In Air":"Damages foes in air","Dmg Underground":"Damages foes underground","Bone Based":"Is a bonemove","Dmg Ungrounded Ignore Type If Flying":"","Thaw User":"Unfreeze the user","Protection Move":"Gives protection to the user","Dmg 2x In Air":"Damage the foes in air with 2X damage","Stat Stages Ignored":"Ignore Stats boost","Hit In Substitute":"Hit Throught Substitute","Target Ability Ignored":"Target Ability is ignored"},o={"Protect Affected":"Isn't affected by protect","Mirror Move Affected":"Cannot be mirrored"},i=document.createDocumentFragment();for(const t of e){const e=s[t];if(!e)continue;const o=be("div",void 0,e);Oe(2,o,"move-effect",(()=>t),n),i.append(o)}const a=Object.keys(o);for(const t of a){if(-1!=e.indexOf(t))continue;const s=o[t],a=be("div",void 0,s);Oe(2,a,"move-effect",(()=>s),n),i.append(a)}t.empty(),t.append(i)}function r(){$("#moves-types1, moves-types2").each(((e,t)=>{Oe(2,t,"type",(()=>t.children[0].innerText))})),$("#moves-name, #moves-internal-id").on("click",(function(){$("#moves-name, #moves-internal-id").toggle()})),Oe(2,$("#moves-split").parent()[0],"category",(()=>$("#moves-split")[0].dataset.split||""))}const l={name:(e,t)=>{const n=t.name.toLowerCase();return!!he(e,n)&&[n===e,n,!0]},move:(e,t)=>{const n=t.name.toLowerCase();return!!he(e,n)&&[n===e,n,!0]},type:(e,t)=>{const n=t.types.map((e=>re.typeT[e].toLowerCase()));for(const t of n)if(he(e,t))return t;return!1},"move-effect":(e,t)=>{const n=t.flags.map((e=>re.flagsT[e].toLowerCase()));for(const t of n)if(he(e,t))return t;return!1},category:(e,t)=>{const n=re.splitT[t.split].toLowerCase();if(he(e,n))return n}};function d(e,t,n){const s=Math.round(Math.sqrt(e.length)),o=be("div","cubic-radial");o.style.width=`calc(${t} * ${s})`,o.style.height=`calc(${n} * ${s})`;for(let i=0;i<s;i++)for(let a=0;a<s;a++){const c=e[i*s+a];if(!c)continue;const r=be("div","radial-btn",c[0]);r.style.left=`calc(${t} * ${a})`,r.style.top=`calc(${n} * ${i})`,r.onclick=e=>{c[1](e),e.stopPropagation()},r.style.width=t,o.append(r)}return o}const p="ERdex",u=p+"_settings",f=["blueish","rushed","wood","blahaj"],m={};function v(){try{window.localStorage&&window.localStorage.setItem(u,JSON.stringify(m))}catch(e){alert("couldn't save settings, report to the dev if this message appear")}}function g(e,t){if(void 0!==window.localStorage)if("object"==typeof t)try{window.localStorage.setItem(p+e,JSON.stringify(t))}catch(e){!function(){if(!localStorage)return;console.log("cleaned the local storage of data");const e=Object.keys(localStorage);for(const t of e)-1!=t.indexOf("ERdex")&&-1!=t.indexOf("ERdexdata")&&localStorage.removeItem(t)}()}else try{window.localStorage.setItem(p+e,t)}catch(e){}}function h(e){try{if(void 0===window.localStorage)return;const t=window.localStorage.getItem(p+e);return"null"===t||null===t?void 0:t}catch(e){return}}function y(){let e=m.theme;-1==f.indexOf(e)&&(e=f[0]);for(const t of f)document.getElementById(`styles-${t}`).disabled=t!==e}function b(){$("#settings-btn").on("click",(function(){$("#settings-frame").toggle()})),$("#disable-storage").on("change",(()=>{m.storageEnable=!1,v()})),$("#enable-storage").on("change",(()=>{m.storageEnable=!0,v()})),m.storageEnable||$("#disable-storage").attr("checked",!0);const e=e=>e.charAt(0).toUpperCase()+e.slice(1),t="theme",n=e(t),s=document.createDocumentFragment(),o=document.createElement("div");o.className="settings-row";const i=document.createElement("span");i.innerText=n+":",s.append(i);for(const n of f){const o=document.createElement("label");o.htmlFor=`${t}-${n}`,o.innerText=e(n);const i=document.createElement("input");i.type="radio",i.name=t,i.id=`${t}-${n}`,m[t]===n&&(i.checked=!0),i.onchange=()=>{m.theme=n,v(),y()},s.append(o),s.append(i)}o.append(s),$("#settings-frame").append(o)}const k=["spc","isShiny","abi","moves","item","ivs","evs","nature"];class E{constructor(){this.node=null,this.baseSpc=null,this.spc=null,this.spcName="",this.isShiny=!1,this.abi=null,this.abiName="",this.inns=Array(3),this.moves=[null,null,null,null],this.item=-1,this.nature=null,this.ivs=Array(6),this.evs=Array(6)}getSpritesURL(){return this.isShiny?nt(this.baseSpc.NAME):tt(this.baseSpc.NAME)}init(e){this.baseSpc=re.species[e],this.spc=e,this.spcName=this.baseSpc.name,this.isShiny=!1,this.abi=0,this.ability=this.baseSpc.stats.abis[0],this.abiName=re.abilities[this.ability].name,this.inns=this.baseSpc.stats.inns,this.innsNames=this.inns.map((e=>re.abilities[e].name)),this.allMoves=re.species[e].allMoves,this.allMovesName=re.species[e].allMoves.map((e=>re.moves[e].name));const t=[...Array(4).keys()].map((e=>this.allMoves[e]||0));this.moves=t,this.item=-1,this.nature=0,this.ivs=[31,31,31,31,31,31],this.evs=[0,0,0,0,0,0]}fromSave(e){this.init(e.spc),k.forEach((t=>{this[t]=e[t]}))}save(){const e={};return k.forEach((t=>{e[t]=this[t]})),e}}class S{constructor(e){return this.node=e,this}init(){this.spc=this.node.find(".trainers-poke-specie"),this.sprite=this.node.find(".trainer-poke-sprite"),this.abi=this.node.find(".trainers-poke-ability"),this.moves=this.node.find(".trainers-poke-move"),this.item=this.node.find(".trainers-poke-item"),this.nature=this.node.find(".trainers-poke-nature"),this.ivs=this.node.find(".trainers-poke-ivs"),this.evs=this.node.find(".trainers-poke-evs")}}const w=[],A=[...Array(6).keys()].map((e=>new E));function N(){const e=h("team-builder");e&&x(JSON.parse(e))}function x(e){for(let t=0;t<6;t++){const n=e[t];if(!n||!n.spc)return M($("#builder-data").find(".builder-mon").eq(t),t);A[t].fromSave(n),L($("#builder-data").find(".builder-mon").eq(t),t)}}function C(){g("team-builder",A.map((e=>e.save())))}function T(){let e=0;[["#builder-editor-btn","#builder-editor"],["#builder-team-btn","#builder-team"]].forEach(((t,n,s)=>{const o=$(t[0]),i=$(t[1]);o.on("click",(()=>{$(s[e][0]).removeClass("btn-active").addClass("btn-n-active"),o.removeClass("btn-n-active").addClass("btn-active"),$(s[e][1]).hide(),i.show(),e=n}))})),$("#builder-data").find(".builder-mon").each((function(e,t){A[e].spc?L($(this),e):D($(this),e),$(this)[0].ondragover=function(e){e.preventDefault()},$(this)[0].ondrop=t=>{t.preventDefault();const n=t.dataTransfer.getData("id");A[e].init(n),L($(this),e)},w.push(new S($(this)))}))}function L(e,t){const n=be("div","builder-mon-delete","Delete");n.onclick=n=>{n.stopPropagation(),M(e,t)},e.empty().append(R(A[t])).append(n),e.children().eq(0).attr("class","trainers-pokemon trainers-pokemon-builder"),e[0].onmouseover=()=>{$(n).show()},e[0].onmouseleave=()=>{$(n).hide()};let o=0,i=!1;const a=document.body.offsetWidth/2;e[0].ontouchstart=e=>{i=!0,o=e.touches[0].clientX},e[0].ontouchend=n=>{i&&(n.changedTouches[0].clientX-o>a&&M(e,t),i=!1)},function(e,t){const n=A[t],o=w[t],i=e.find(".trainer-poke-sprite")[0],a=e.find(".trainers-poke-ability")[0],c=e.find(".trainers-poke-moves")[0],r=(be("div","builder-editor-right"),e.find(".trainers-poke-item")[0]),l=e.find(".trainers-poke-nature")[0],p=e.find(".trainers-stats-row")[0];i.onclick=()=>{n.isShiny=!n.isShiny,o.sprite[0].src=n.getSpritesURL(),C()},a.onclick=e=>{e.stopPropagation();const i=function(e,t){const s=be("div","builder-overlay-abis-inns"),i=be("div","builder-overlay-abis-desc"),c=be("div","builder-overlay-abilities"),r=[...new Set(A[e].baseSpc.stats.abis)].map(((e,t)=>{const s=re.abilities[e];return be("div","builder-overlay-ability",s.name,{onclick:e=>{var c;e.stopPropagation(),c=t,n.abi=c,n.abiName=re.abilities[n.baseSpc.stats.abis[c]].name,o.abi.text(n.abiName),a.innerText=n.abiName,C(),i.innerText=s.desc},onmouseover:()=>{i.innerText=s.desc},onmouseleave:()=>{i.innerText=""}})})),l=be("div","builder-overlay-innates"),d=A[e].baseSpc.stats.inns.map(((e,t)=>{const n=re.abilities[e];return be("div","builder-overlay-innate",n.name,{onclick:e=>{e.stopPropagation(),i.innerText=n.desc},onmouseover:()=>{i.innerText=n.desc},onmouseleave:()=>{i.innerText=""}})}));return $e([s,[c,r,l,d,i]])}(t);s(i,e,"",!0)},c.onclick=e=>{e.stopPropagation();const t=d(n.moves.map(((t,i)=>[re.moves[t].name,()=>{s(I((e=>{n.moves[i]=n.allMoves[e];const t=n.allMovesName[e];o.moves.eq(i).text(t),C()}),n.allMovesName),e,"focus")}])),"6em","1em");s(t,e,"mid")};const u=e=>{n.item=e,o.item.text(r.innerText=re.items[e].name),C()},f=e=>{n.nature=e,L(o.node,t),C()},m=(e,s,i)=>{n[e][s]=i,L(o.node,t),C()};p.onclick=r.onclick=l.onclick=e=>{e.stopPropagation();const n=d([["Items",e=>{s(I(u,re.itemT),e,"focus")}],["Nature",e=>{s(I(f,re.natureT.map((e=>H(e)))),e,"focus")}],["IVs",e=>{s(P("ivs",t,m),e)}],["EVs",e=>{s(P("evs",t,m),e)}]],"6em","1em");s(n,e,"mid")}}(e,t),w[t].init(),C()}function M(e,t){e.empty(),$("#builder-editor").empty(),D(e,t),A[t]=new E,C()}function D(e,t){let n;n=be("div","builder-placeholder",navigator.maxTouchPoints?"tap to add the selected pokemon from the list":"drop a mon from the list or click to add the selected pokemon from the list"),n.onclick=()=>{const n=$("#species-list .sel-active")[0].dataset.id;A[t].init(n),L(e,t)},e.append(n)}function I(e,t){let n=!1;const s=be("input","builder-overlay-list");s.setAttribute("list","item-datalist");const o=be("datalist");o.id="item-datalist";const i=t.map((e=>{const t=be("option");return t.value=e,t}));return s.onclick=function(e){n||e.stopPropagation()},s.onkeyup=s.onchange=o=>{const i=t.indexOf(s.value);-1!=i&&(e(i),"Enter"===o.key&&(n=!0,s.click()))},$e([s,o,i])}const F=["HP","Atk","Def","SpA","SpD","Spe"],O={ivs:e=>(e=+e.replace(/[^0-9-]/g,""),isNaN(e)?0:Math.min(Math.max(0,e),31)),evs:e=>(e=+e.replace(/[^0-9-]/g,""),isNaN(e)?0:Math.min(Math.max(0,4*Math.round(e/4)),252))};function P(e,t,n){const s=A[t],o=be("div","overlay-stats-edition"),i=be("div","overlay-stats-row");return F.forEach(((t,o)=>{const a=be("div","overlay-stats-column"),c=be("label","overlay-stats-label",t);c.setAttribute("for",`overlay-stats-edit${o}`);const r=be("input","overlay-stats-edit");r.id=`overlay-stats-edit${o}`,r.value=s[e][o],r.type="number",r.onclick=r.onchange=()=>{r.value=O[e](r.value),n(e,o,r.value)},i.append($e([a,[c,r]]))})),i.onclick=function(e){e.stopPropagation()},$e([o,[i]])}const _={elite:!1};let B=0;function G(e){B=e,$("#trainers-list").find(".sel-active").addClass("sel-n-active").removeClass("sel-active"),$("#trainers-list > .btn").eq(e-1).addClass("sel-active").removeClass("sel-n-active");const t=re.trainers[e];$("#trainers-name").text(t.name),function(e){const t=e.party;if(!t||t.length<1)return void $("#trainers-normal").empty();const n=be("div");n.innerText="Normal",n.className="trainer-match-btn sel-active",n.onclick=()=>{_.elite=!1,q(t),$("#trainers-infobar").find(".sel-active").addClass("sel-n-active").removeClass("sel-active"),n.className="trainer-match-btn sel-active"},$("#trainers-normal").empty().append(n),V(e.db)}(t),function(e){if(e.length<1)return $("#trainers-rematch").empty();const t=document.createDocumentFragment(),n=be("span");n.innerText="Rematches :",t.append(n);for(const n in e){const s=e[n],o=be("div");o.innerText=+n+1,o.className="trainer-match-btn sel-n-active",o.onclick=()=>{q(s.party),$("#trainers-infobar").find(".sel-active").addClass("sel-n-active").removeClass("sel-active"),$("#trainers-rematch").children().eq(+n+1).addClass("sel-active").removeClass("sel-n-active"),V(s.db)},t.append(o)}$("#trainers-rematch").empty().append(t)}(t.rem),function(e){const t=e.insane;if(!t||t.length<1)return void $("#trainers-elite").empty();const n=be("div");n.innerText="Elite",n.className="trainer-match-btn sel-n-active",n.onclick=()=>{_.elite=!0,q(t),$("#trainers-infobar").find(".sel-active").addClass("sel-n-active").removeClass("sel-active"),n.className="trainer-match-btn sel-active"},$("#trainers-elite").empty().append(n),V(e.db),_.elite&&n.onclick()}(t),q(t.party)}function V(e){e?$("#trainers-double").show():$("#trainers-double").hide()}function q(e){if(e.length<1)return console.warn("party had team "+e);const t=document.createDocumentFragment();for(const n of e){const e=R(n);e.firstChild.onclick=()=>{ze(n.spc)},t.append(e)}$("#trainers-team").empty().append(t).append(function(e){return $e([be("div","trainer-go-edition",null,{onclick:()=>{x(e),$("#btn-species").click(),"Species"===$("#btn-species").find(".big-select").text()&&$("#btn-species").click()}}),[be("div","trainer-redirect-arrow","Edit In Builder →")]])}(e))}function R(e){const t=re.species[e.spc],n=re.abilities[t.stats.abis[e.abi]],s=e.moves.map((e=>re.moves[e])),o=re.items[e.item]?.name,i=re.natureT[e.nature],a=be("div","trainers-pokemon"),c=be("div","trainers-pokemon-left"),r=be("div","trainers-poke-specie",t.name),l=be("img","trainer-poke-sprite");e.isShiny?l.src=nt(t.NAME):l.src=tt(t.NAME);const d=be("div","trainers-poke-ability",n?.name),p=be("div","trainers-pokemon-mid"),u=be("div","trainers-poke-moves");for(const e of s){if(!e)continue;const t=re.typeT[e.types[0]].toLowerCase();u.append(be("div",`trainers-poke-move ${t}-t`,e.name))}const f=be("div","trainers-pokemon-right"),m=be("div","trainers-poke-item",o),v=H(i),g=be("div","trainers-poke-nature",v),h=["HP","Atk","Def","SpA","SpD","Spe"],y=be("div","trainers-stats-row"),b=v.match(/(?<=\+)\w+/)?.[0],$=v.match(/(?<=\-)\w+/)?.[0];for(const t in h){const n=h[t],s=n===b?"buffed":n===$?"nerfed":"",o=e.evs[t],i=o>=200?"buffed":"",a=e.ivs[t],c=0==a?"nerfed":"";y.append($e([be("div","trainers-stats-col"),[be("div",`trainers-stats-name ${s}`,n),be("div",`trainers-poke-ivs ${c}`,a),be("div",`trainers-poke-evs ${i}`,o)]]))}return $e([a,[c,[r,l,d],f,[p,[u,m,g],y]]])}const U={Impish:"+Def -SpA",Adamant:"+Atk -SpA",Bold:"+Def -Atk",Bashful:"--",Jolly:"+Spe -SpA","Gentle ":"+SpD -Def",Calm:"+SpD -Atk",Quiet:"+SpA -Spe",Modest:"+SpA -Atk",Timid:"+Spe -Atk",Careful:"+SpD -SpA",Hasty:"--",Naughty:"+Atk -SpD",Sassy:"+SpD -Spe",Naive:"+Spe -SpD",Brave:"+Atk -Spe",Lonely:"+Atk -Def",Relaxed:"+Def -Spe",Lax:"+Def -SpD",Hardy:"--",Rash:"+SpA -SpD",Mild:"+SpA -Def",Quirky:"--",Serious:"--"};function H(e){return`${e} (${U[e]})`}const W={name:(e,t)=>!!he(e,t.name.toLowerCase())&&t.name,map:(e,t)=>{const n=re.mapsT[t.map]?.toLowerCase();return!(!n||!he(e,n))&&n},specie:(e,t)=>{const n=[].concat.apply([],[t.party,[].concat.apply([],t.rem.map((e=>e.party))),t.insane]);for(const t of n){const n=re.species[t.spc].name.toLowerCase();if(he(e,n))return n}return!1}},j=[];let K=!1;function z(e,t,n=!1){j.push(t);try{$("#loading").append($e([be("div","loading-row"),[be("div","loading-text",`loading ${t}`),be("div","loading-icons","⟳")]])),e(),J(t,!0)}catch(e){J(t,!1)}finally{n&&(K?($("#loading").append(be("div","loading-ask","An error occured, click to continue")),$("#loading").on("click",(function(){$("#loading-screen").hide(),$("#loading").off("click")}))):$("#loading-screen").hide())}}function J(e,t){const n=$("#loading").children().eq(j.indexOf(e));n.find(".loading-icons").text(t?"✅":"❌"),n.find(".loading-text").text(`${e}`),K=!t||K}const Y={species:[],abilities:[],moves:[],locations:[],trainers:[]};function Q(e=!1){if(!re)return console.warn("couldn't find gameData");re.minMaxBaseStats=new Array(6).fill(0),re.speciesStats={result:{top5:new Array(6).fill(0),top20:new Array(6).fill(0),median:new Array(6).fill(0),min20:new Array(6).fill(0),min5:new Array(6).fill(0),maxBST:0},data:[[],[],[],[],[],[],[]]};const t=[[Z,"abilities data"],[ee,"moves data"],[ne,"species  data"],[se,"locations  data"],[ae,"trainers data"],[ce,"items data"],[N,"save"]],n=t.length;for(let s=0;s<n;s++){const o=t[s];e?z(o[0],o[1],s==n-1):o[0]()}}function X(e,t){re.speciesStats.data[e].push(t),6==e&&t>re.speciesStats.result.maxBST&&(re.speciesStats.result.maxBST=t)}function Z(e=re.abilities){$("#abis-list").empty().append($e(e.map(((e,t)=>{if("-------"===e.name)return;const n=$e([be("div","abi-row"),[be("div","abi-name color"+(t%2?"A":"B"),e.name),be("div","abi-desc color"+(t%2?"C":"D"),e.desc)]]);return Y.abilities.push(n),n})).filter((e=>e))))}function ee(e=re.moves){const t=document.createDocumentFragment();for(const n in e){if(0==n)continue;const s=e[n],o=document.createElement("div");o.className="btn data-list-row sel-n-active";const i=document.createElement("span");i.innerText=s.name||"Unknown",o.append(i),o.dataset.id=n,$(o).on("click",(function(){fastdom.mutate((()=>{$("#filter-frame").hide(),a($(this).attr("data-id"))}))})),t.append(o)}$("#moves-list").empty().append(t),a(1)}function te(e,t){if(-1==t.in||t.from)return;const n=re.species[e],s=re.species[t.in];s.eggMoves.length||(s.eggMoves=n.eggMoves),s.TMHMMoves.length||(s.TMHMMoves=n.TMHMMoves),s.tutor.length||(s.tutor=n.tutor),s.evolutions.push({kd:t.kd,rs:t.rs,in:e,from:!0}),s.region||(s.region=n.region)}function ne(){Y.species=[];const e=document.createDocumentFragment(),t=re.species;e.append(function(){const e=be("div","data-list-row","reorder");function t(e,t){return e.name.localeCompare(t.name)}function n(e,t,n){return t.stats.base[e]-n.stats.base[e]}const i=$("#species-list"),a=(e,t)=>{s(d([["STRONGER First >",e=>{Ee(i,n.bind(null,t),">"),o(e)}],["weaker first <",e=>{Ee(i,n.bind(null,t),"<"),o(e)}],void 0,void 0],"8em","1em"),e,"mid",!0,!0)};return e.onclick=e=>{s(d([["Default",e=>{Ee(i),o(e)}],["A-Z",e=>{Ee(i,t),o(e)}],["Stats",()=>{s(d([["HP",e=>{a(e,0)}],["Atk",e=>{a(e,1)}],["Def",e=>{a(e,2)}],["SpA",e=>{a(e,3)}],["SpD",e=>{a(e,4)}],["Spe",e=>{a(e,5)}],["BST",e=>{a(e,6)}],void 0],"4em","1em"),e,"mid",!0,!1)}]],"6em","1em"),e,"mid",!0,!1)},e}());for(const n in t){if(0==n)continue;const s=t[n];s.stats.base[6]=0;for(const e in s.stats.base){const t=s.stats.base[e];X(e,t),e<6&&(s.stats.base[6]+=+t)}s.locations=new Map,s.allMoves=[...new Set(s.eggMoves.concat(s.levelUpMoves.map((e=>e.id)).concat(s.TMHMMoves.concat(s.tutor))))];for(const e of[[0,"Kanto"],[151,"Johto"],[251,"Hoenn"],[386,"Sinnoh"],[494,"Unova"],[649,"Kalos"],[721,"Alola"],[809,"Galar"],[898,"Hisui"],[905,"Paldea"],[1500,""],[1547,"Alola"],[1568,"Galar"],[1587,""],[1808,"Hisui"],[1824,""],[2300,"Redux"]]){if(s.id<=e[0])break;s.region=e[1]}for(const e of s.evolutions)te(n,e);const o=be("div","btn data-list-row sel-n-active");o.setAttribute("draggable",!0),o.ondragstart=e=>{e.dataTransfer.setData("id",n)},s.nodeID=Y.species.length,Y.species.push(o);const i=be("img","species-list-sprite");i.src=tt(s.NAME),i.alt=s.name,i.loading="lazy",o.appendChild(i);const a=be("span","species-name",s.name);o.append(a),o.dataset.id=n,$(o).on("click",(function(){$("#filter-frame").hide(),fastdom.mutate((()=>{Ke($(this).attr("data-id"))}))})),e.append(o)}!function(){for(const e in re.speciesStats.data){const t=re.speciesStats.data[e].sort(((e,t)=>e-t)),n=t.length;re.speciesStats.result.min5[e]=t[Math.ceil(.05*n)],re.speciesStats.result.min20[e]=t[Math.ceil(.2*n)],re.speciesStats.result.median[e]=t[Math.ceil(.5*n)],re.speciesStats.result.top20[e]=t[Math.ceil(.8*n)],re.speciesStats.result.top5[e]=t[Math.ceil(.95*n)]}delete re.speciesStats.data}(),$("#species-list").empty().append(e),Ke(1)}function se(){const e=["land","water","fish","honey","rock","hidden"],t=document.createDocumentFragment(),n=re.locations.maps;for(const s in n){const o=n[s];o.speciesSet=new Set;for(const t of e){const e=o[t];if(e)for(const n of e){const e=n[2];e<1||(o.speciesSet.add(re.species[e].name.toLowerCase()),re.species[e].locations.get(s)||re.species[e].locations.set(s,new Set),re.species[e].locations.get(s).add(t))}}const i=document.createElement("div");i.className="btn data-list-row sel-n-active";const a=document.createElement("span");a.innerText=o.name||"unknown",i.append(a),i.dataset.id=s,$(i).on("click",(function(){fastdom.mutate((()=>{_e($(this).attr("data-id"))}))})),t.append(i)}$("#locations-list").empty().append(t);const s=re.locations;for(const t of e){const e=s[t+"Rate"];if(!e)continue;const n=document.createDocumentFragment();if("fish"!==t){for(const t of e)n.appendChild(ie(t));$("#locations-"+t).empty().append(n)}else $("#locations-"+t).empty().append(oe(e))}_e(0)}function oe(e){const t=document.createDocumentFragment();let n=document.createElement("div");n.className="location-rod",n.innerHTML="Old Rod",t.append(n);const s=re.locations.rodGrade;for(let o=0;o<e.length;o++)e[o],o===s[0]+1&&(n=document.createElement("div"),n.className="location-rod",n.innerText="Good Rod",t.append(n)),o===s[1]+1&&(n=document.createElement("div"),n.className="location-rod",n.innerText="Super Rod",t.append(n)),t.append(ie(e[o]));return t}function ie(e){const t=document.createElement("div");t.className="location-row";const n=document.createElement("div");n.className="location-rate",n.innerText=e,t.append(n);const s=document.createElement("div");s.className="location-specie",t.append(s);const o=document.createElement("div");return o.className="location-lvl",t.append(o),t}function ae(){const e=document.createDocumentFragment(),t=re.trainers;for(const n in t){if(0==n)continue;const s=t[n],o=document.createElement("div");o.className="btn data-list-row sel-n-active";const i=document.createElement("span");i.innerText=s.name||"unknown",o.append(i),o.dataset.id=n,$(o).on("click",(function(){fastdom.mutate((()=>{G($(this).attr("data-id"))}))})),e.append(o)}$("#trainers-list").empty().append(e),G(1)}function ce(){re.itemT=[],re.items.forEach((e=>{re.itemT.push(e.name)}))}let re,le;const de="7",pe=["1.6.1","Alpha"],ue="1.6.1";function fe(e=ue,t=!1){e&&-1!=pe.indexOf(e)||(console.warn(`no such version : ${e}, defaulting to ${ue}`),e=ue),fetch(`js/data/comparify${e}Vanilla.json`).then((e=>e.json())).then((e=>{console.log("took compareData from server"),le=e})).catch((e=>{console.warn(e)})).catch((e=>{console.warn(e)}));const n=h("dataversion"+e);if(g("lastusedversion",e),n&&n==de&&$("#enable-storage")[0].checked)try{if(re=JSON.parse(h("data"+e)),re)return console.log("took gamedata from storage"),void Q(t)}catch(e){console.log(e)}fetch(`js/data/gameDataV${e}.json`).then((e=>e.json())).then((n=>{console.log("took gamedata from server"),re=n,Q(t);try{g("data"+e,re),g("dataversion"+e,de)}catch(e){}}))}function me(){!function(){const e=document.createDocumentFragment();for(const t of pe){const n=document.createElement("option");n.value=t,n.innerText=t,e.append(n)}$("#versions").append(e).val(ue).change()}(),$("#versions").on("change",(function(){fe($(this).val())}))}function ve(e,t){const n=document.createElement("div");n.innerText=t,n.className="tooltip",e.onmouseover=()=>{n.style.display="block"},e.onmouseleave=()=>{n.style.display="none"},e.ontouchstart=()=>{n.style.display="block"===n.style.display?"none":"block"},e.appendChild(n)}function ge(e){return e.charAt(0).toUpperCase()+e.slice(1)}function he(e,t){return-1!=t.indexOf(e)}function ye(e,t){const n=s=>{t!=s.target&&(e.style.display="none",$(document).off("click",n))};$(document).on("click",n)}function be(e="div",t="",n="",s={}){const o=document.createElement(e);t&&(o.className=t),o.innerText=n;for(const e in s)o[e]=s[e];return o}function $e(e){const t=document.createDocumentFragment();for(let n=0;n<e.length;n++){const s=e[n];"Array"!==s.constructor.name?t.append(s):e[n-1].append($e(s))}return t}function ke(e,t,n=500,s="red"){const o=be("div","extend");o.style.backgroundColor=s,o.style.display="none",e.append(o),e.style.position="relative";const i={ev:{}},a=e.onclick?.bind(i);let c;e.onclick=null;let r=!0;const l=e=>{o.style.display="block",r=!1,c=setTimeout((()=>{r=!0,t()}),n),o.animate([{width:"0%"},{width:"100%"}],{duration:n,iterations:1})},d=e=>{o.style.display="none",i.ev=e,!r&&a&&a.apply(),e.stopImmediatePropagation(),clearTimeout(c)};return e.addEventListener("mousedown",l),e.addEventListener("touchstart",l),e.addEventListener("mouseup",d),e.addEventListener("touchend",d),o}function Ee(e,t,n="<"){fastdom.mutate((()=>{let s;s=t?structuredClone(re.species).sort(t):structuredClone(re.species),">"===n&&(s=s.reverse());const o=s.length;for(var i=0;i<o;i++){const t=s[i];void 0!==t.nodeID&&e.append(Y.species[t.nodeID])}}))}const Se=[{name:"Species",filters:[],modify:function(){we(0)}},{name:"Abilities",filters:[],modify:function(){we(1)}},{name:"Moves",filters:[],modify:function(){we(2),Ye()}},{name:"Locations",filters:[],modify:function(){we(3)}},{name:"Trainers",filters:[],modify:function(){we(4)}}];function we(e){const t=mt.panelUpdatesIndex;mt.panelUpdatesIndex=e,mt.clearSuggestion(),mt.panelUpdatesTable[e](Ne()),mt.showSuggestion(),mt.panelUpdatesIndex=t}let Ae=[];function Ne(){let e;return Ae=[{op:"AND",not:!1,k:$("#search-keys").val().toLowerCase(),data:$("#search-bar").val().toLowerCase(),suggestion:$("#search-bar")[0]===mt.suggestionInput}],$(".filter-row").map((function(e,t){Se[e].filters=[];const n=t.querySelectorAll(".filter-field"),s=n.length;if(s)for(let t=0;t<s;t++){const s=n[t],o={op:"AND",not:"on"===s.querySelector(".filter-not").dataset.state,k:s.querySelector(".filter-key").value.toLowerCase(),data:s.querySelector(".filter-search").value.toLowerCase(),suggestion:s.querySelector(".filter-search")===mt.suggestionInput};Se[e].filters.push(o)}})),Ae.push(...Se[mt.panelUpdatesIndex].filters),Ae=Ae.filter((e=>e.data)),e=1==Ae.length?Ae[0]:{op:$("#filter-main-operator").val(),not:!1,k:"",data:Ae},e}function xe(e){if(mt.defrosting&&mt.defrostFuturePanel(),mt.updateGuard)mt.updateQueue=!0;else{for(mt.updateGuard=!0;fastdom.mutate((()=>{mt.clearSuggestion(),mt.panelUpdatesTable[mt.panelUpdatesIndex](Ne()),mt.showSuggestion(),e&&e(),mt.callbackAfterFilters&&(mt.callbackAfterFilters(),mt.callbackAfterFilters=null),mt.searchKeys[mt.panelUpdatesIndex]=$("#search-keys").val(),mt.searchData[mt.panelUpdatesIndex]=$("#search-bar").val()})),mt.updateQueue;)mt.updateQueue=!1;mt.updateGuard=!1}}function Ce(e,t="",n=""){const s=be("div","filter-field"),o=be("div","filter-not","¿?");o.type="button",o.dataset.state="off";const i=be("div","filter-key-wrapper"),a=be("input","filter-key");a.type="button",a.value=t||mt.queryKeys[0]||"Name",a.onchange=()=>{Se[e].modify()};const c=be("div","filter-key-selection");c.style.display="none";const r=be("label","filter-label"),l=be("input","filter-search");l.type="search",l.value=n,l.setAttribute("value",l.value);const d=be("div","filter-suggestions");d.style.display="none";const p=be("div","filter-remove","X"),u=$e([s,[o,i,[a,c,[...Object.keys(mt.queryMapList[e]).map((t=>{const n=be("div","",t);return n.onclick=()=>{a.value=t,$(c).hide(),Se[e].modify()},n}))]],r,[l,d],p]]);return o.onclick=()=>{"off"===o.dataset.state?(o.dataset.state="on",o.classList.add("filter-not-not"),a.classList.add("filter-not-not")):(o.dataset.state="off",o.classList.remove("filter-not-not"),a.classList.remove("filter-not-not")),Se[e].modify()},a.onclick=()=>{$(c).show(),ye(c,a)},l.onclick=()=>{mt.suggestionNode&&(mt.suggestionNode.style.display="none"),mt.suggestionNode=d},l.onkeyup=t=>{vt(t,d,l,Se[e].modify)},p.onclick=()=>{s.remove(),Se[e].modify(),De()},$("#filter-data").find(".filter-add").eq(e).before(u),Me(),s}function Te(e,t,n){if(e.data.constructor===Array){const s=e.data.map((e=>Te(e,t,n))).filter((e=>e));if(s.length<1)return;if(1==s.length)return s[0];let o=s.splice(0,1)[0];const i=s.length;for(let t=0;t<i;t++){const n=s[t];if(o.push(...n),"OR"===e.op)o=[...new Set(o)];else if("XOR"===e.op){const e=[],t=o.length;for(let n=0;n<t;n++){const t=o.splice(0,1)[0];-1==o.indexOf(t)&&e.push(t),o.push(t)}o=e}else{const e=[],t=o.length;for(let n=0;n<t;n++){const t=o.splice(0,1)[0];-1!=o.indexOf(t)&&e.push(t)}o=e}}return o}{const o=n[e.k];if(!o)return;const i=[],a=[],c=t.length;for(let n=0;n<c;n++){const r=t[n],l=o(e.data,r);let d;if("object"==typeof l){const t=l[0];if(d=l[1],t){if(l[2]){if(e.not){const e=[...Array(c).keys()];return e.splice(n,1),e}return[n]}a.push(n)}}else d=l;s=d,(e.not?!s:s)&&(i.push(n),e.suggestion&&mt.addSuggestion(d))}return a.length?a:i}var s}function Le(){$("#filter-frame").find(".filter-field").remove(),De(),xe()}function Me(){$("#filter-icon")[0].animate([{rotate:"0deg"},{backgroundColor:"green"},{rotate:"360deg"}],{duration:750,iterations:1})}function De(){$("#filter-icon")[0].animate([{rotate:"0deg"},{backgroundColor:"red"},{rotate:"-360deg"}],{duration:750,iterations:1})}function Ie(e,t,n){const s=$("#filter-data").children().eq(n);return s.find(`.filter-key[value="${e.toLowerCase()}"]`)&&s.find(`.filter-search[value="${t}"]`)[0]}function Fe(){$("#filter-clear-all").on("click",(function(){Le()})),$(".filter-help-btn").on("click",(function(){$("#filter-help").toggle(),$(".filter-panel").toggle()})),$("#filter-main-operator").on("change",(function(){xe()})),ke($("#to-filter")[0],(()=>{Le()})),$("#filter-data").append(Se.map(((e,t)=>$e([be("div","filter-row"),[be("div","filter-target"),[be("span","",e.name)],be("div","filter-list"),[be("div","filter-add",null,{onclick:e=>{Ce(t)}}),[be("span","filter-plus","+"),be("span","","Add a filter")]]]]))))}function Oe(e,t,n,s=(()=>t.innerText),o=!1){let i,a,c=ke(t,(()=>{Ie(n,s(),e)?(i?i.remove():$(".filter-search").each(((e,t)=>{t.value===s()&&$(t).closest(".filter-field").remove()})),De(),a="green"):(i=Ce(e,n,s()),a="red"),xe(),c.style.backgroundColor=a,o&&o()}),450,Ie(n,s(),e)?"red":"green")}let Pe=0;function _e(e){Pe=e;const t=re.locations.maps[e],n=["land","water","fish","honey","rock","hidden"];for(const e of n){const n=t[e],s=$("#locations-"+e);if(n){s.parent().show();for(const e in n){const t=n[e];s.find(".location-specie").eq(e).empty().append(dt(t[2])),s.children().find(".location-lvl").eq(e).text(t[0]+"-"+t[1])}}else s.parent().hide()}$("#locations-list").find(".sel-active").addClass("sel-n-active").removeClass("sel-active"),$("#locations-list").children().eq(e).addClass("sel-active").removeClass("sel-n-active")}const Be={name:(e,t)=>!!he(e,t.name.toLowerCase())&&t.name,specie:(e,t)=>{for(const n of t.speciesSet)if(he(e,n))return n;return!1}},Ge={Normal:[["Ghost"],[],["Fighting"]],Fighting:[[],["Bug","Rock","Dark"],["Flying","Psychic","Fairy"]],Fire:[[],["Fire","Grass","Ice","Bug","Steel","Fairy"],["Water","Ground","Rock"]],Ice:[[],["Ice"],["Fire","Fighting","Rock","Steel"]],Electric:[[],["Electric","Flying","Steel"],["Ground"]],Bug:[[],["Grass","Fighting","Ground"],["Fire","Rock","Flying"]],Flying:[["Ground"],["Grass","Fighting","Bug"],["Electric","Ice","Rock"]],Steel:[["Poison"],["Normal","Grass","Ice","Flying","Psychic","Bug","Rock","Dragon","Steel","Fairy"],["Fire","Fighting","Ground"]],Grass:[[],["Water","Electric","Grass","Ground"],["Fire","Ice","Poison","Flying","Bug"]],Ground:[["Electric"],["Poison","Rock"],["Water","Grass","Ice"]],Poison:[[],["Grass","Fighting","Poison","Bug","Fairy"],["Ground","Psychic"]],Dark:[["Psychic"],["Ghost","Dark"],["Fighting","Bug","Fairy"]],Water:[[],["Fire","Water","Ice","Steel"],["Electric","Grass"]],Psychic:[[],["Fighting","Psychic"],["Ghost","Bug","Dark"]],Rock:[[],["Normal","Fire","Poison","Flying"],["Water","Grass","Fighting","Ground","Steel"]],Dragon:[[],["Fire","Water","Electric","Grass"],["Ice","Dragon","Fairy"]],Ghost:[["Normal","Fighting"],["Bug","Poison"],["Dark","Ghost"]],Fairy:[["Dragon"],["Fighting","Bug","Dark"],["Poison","Steel"]]};function Ve(e,t){let n=[0,.5,2],s=0;for(const o of Ge[t]){if(-1!=o.indexOf(e))return n[s];s++}return 1}const qe={Phantom:"Ghost",Metallic:"Steel",Dragonfly:"Dragon","Half Drake":"Dragon","Ice Age":"Ice",Grounded:"Ground",Aquatic:"Water",Turboblaze:"Fire",Teravolt:"Electric","Fairy Tale":"Fairy"};const Re={"Flash Fire":["Fire"],"Sap Sipper":["Grass"],"Volt Absorb":["Electric"],"Lightning Rod":["Electric"],"Motor Drive":["Electric"],"Water Absorb":["Water"],"Dry Skin":["Water"],"Storm Drain":["Water"],Evaporate:["Water"],"Wonder Guard":[],Levitate:["Ground"],Dragonfly:["Ground"],Mountaineer:["Rock"],"Poison Absorb":["Poison"]},Ue={"Gifted Mind":Ge.Psychic[2]},He={"Well Baked Body":["Fire"],"Water Bubble":["Fire"],"Sea Weed":["Fire"],Heatproof:["Fire"],"Thick Fat":["Fire","Ice"],Immunity:["Poison"],Fossilized:["Rock"],"Raw Wood":["Grass"]},We={Fluffy:["Fire"],Liquified:["Water"]};let je=1;function Ke(e){je=e;const t=re.species[e];var n;$("#species-name").text(`${t.name}#${t.dex.id||"??"}`),$("#species-id").text(`ingame ID: ${t.id}`),function(e){const t=["#BHP","#BAT","#BDF","#BSA","#BSD","#BSP","#BST"];for(const n in t)st($(t[n]),e[n],n,le?.species?.[je].stats?.base[n])}(t.stats.base),$("#species-front").attr("src",tt(t.NAME)),$("#species-front")[0].onclick=()=>{"off"===$("#species-front")[0].dataset.shiny?($("#species-front")[0].dataset.shiny="on",$("#species-front").attr("src",nt(t.NAME))):($("#species-front")[0].dataset.shiny="off",$("#species-front").attr("src",tt(t.NAME)))},$("#species-front")[0].dataset.shiny="off",function(e,t){$("#species-abilities").empty().append($e(e.map(((n,s)=>{if(e[s]==e[s-1]||0===e[s])return;const o=re.abilities[e[s]],i=be("div","species-ability",o.name);return ve(i,o.desc),i.onclick=()=>{$("#species-abilities .sel-active").removeClass("sel-active").addClass("sel-n-active"),i.classList.replace("sel-n-active","sel-active"),t.activeAbi=s,Je([...new Set(t.stats.types),ot(t.activeAbi,t)],t)},i.classList.add(s?"sel-n-active":"sel-active"),Oe(0,i,"ability",(()=>o.name)),i})).filter((e=>e))))}(t.stats.abis,t),n=t.stats.inns,$("#species-innates").empty().append($e(n.map(((e,t)=>{if(n[t]==n[t-1]||0===n[t])return;const s=re.abilities[n[t]],o=be("div","species-innate",s.name);return Oe(0,o,"ability",(()=>s.name),0),ve(o,s.desc),o})).filter((e=>e)))),t.activeAbi=0,Je([...new Set(t.stats.types),ot(t.activeAbi,t)],t),Ye(t),function(e){const t=document.createDocumentFragment();for(const n of e){if(-1==n.in)continue;const e=document.createElement("div");e.className="evo-parent";const s=document.createElement("span");s.className="evo-into",s.innerText=n.from?"From":"Into ",s.appendChild(dt(n.in)),e.append(s);const o=document.createElement("div");o.className="evo-reason",o.innerText=pt(n.kd,n.rs),e.append(o),t.append(e)}$("#species-evos").empty().append(t)}(t.evolutions),function(e,t){const n=document.createDocumentFragment();for(const[t,s]of e){const e=re.locations.maps[t];if(!e)continue;const o=document.createElement("div");o.className="specie-locs";let i=`Can be found at ${e.name}`,a=!0;for(const e of s)a?a=!1:i+=" and",i+=` on ${ge(e)}`;o.innerText=i,o.onclick=()=>{var e;e=t,mt.callbackAfterFilters=()=>{$("#locations-list").children().eq(e).click()[0].scrollIntoView({behavior:"smooth"})},$("#btn-locations").click()},n.append(o)}for(const e of t){const t=document.createElement("div");t.className="specie-locs-scripted",t.innerHTML=`Can be found at ${re.mapsT[e.map]} as a ${re.scriptedEncoutersHowT[e.how]}`,n.append(t)}$("#species-locations").empty().append(n)}(t.locations,t.SEnc),$("#species-misc").text(t.dex.desc),$("#species-list").find(".sel-active").addClass("sel-n-active").removeClass("sel-active"),Y.species[e-1].classList.replace("sel-n-active","sel-active")}function ze(e){$("#btn-species")[0].classList.contains("btn-active")?$(Y.species[e-1]).click()[0].scrollIntoView({behavior:"smooth"}):(mt.callbackAfterFilters=()=>{$(Y.species[e-1]).click()[0].scrollIntoView({behavior:"smooth"})},$("#btn-species").click())}function Je(e,t){e=e.filter((e=>null!=e));const n=$("#species-types");for(let t=0;t<3;t++){const s=re.typeT[e[t]]||"",o=n.children().eq(t).children().eq(0);s?(o.show(),o.text(s).attr("class",`type ${s.toLowerCase()}`)):o.hide()}!function(e){const t=document.createDocumentFragment(),n=Object.keys(e).sort();for(const s of n){const n=be("div","species-coverage-row"),o=be("div","species-coverage-mul"),i=be("span","span-align",s);o.append(i),n.append(o);const a=be("div","species-coverage-list"),c=e[s];for(const e of c){const t=be("div",`${e.toLowerCase()} type`),n=be("span","span-align",e.substr(0,5));t.append(n),a.append(t)}n.append(a),t.append(n)}const s=$("#species-coverage");s.empty(),s.append(t)}(function(e,t){const n=function(e){e=e.map((e=>re.abilities[e].name));const t=[[],[],[],[]];for(const n of e){const e=Re[n];e&&t[0].push(...e);const s=Ue[n];s&&t[1].push(...s);const o=He[n];o&&t[2].push(...o);const i=We[n];i&&t[3].push(...i)}return t}(t),s=[];for(const t of re.typeT){let o=1;if(-1==n[0].indexOf(t)){-1!=n[1].indexOf(t)&&(o=1),-1!=n[2].indexOf(t)&&(o=.5),-1!=n[3].indexOf(t)&&(o=2);for(const n of e)o*=Ve(t,n);s.push(o)}else o=0,s.push(o)}const o={};return re.typeT.forEach(((e,t)=>{const n=s[t];o[n]?o[n].push(e):o[n]=[e]})),o}(e.map((e=>re.typeT[e])),[t.stats.abis[t.activeAbi],...t.stats.inns]))}function Ye(e=re.species[je]){!function(e,t){e.empty();const s=document.createDocumentFragment();for(const{lv:e,id:o}of t){if(n&&-1==n.indexOf(o))continue;const t=re.moves[o];if(!t){console.warn(`unable to find move with ID ${o}`);continue}const i=Ze(o),a=document.createElement("div");a.innerText=+e||"Ev",a.className="species-levelup-lvl",i.append(a),i.append(Qe(t)),i.append(Xe(t)),s.append(i)}e.append(s)}($("#learnset"),e.levelUpMoves),et($("#tmhm"),e.TMHMMoves),et($("#tutor"),e.tutor),et($("#eggmoves"),e.eggMoves)}function Qe(e){const t=document.createElement("img");return t.src=`./icons/${re.splitT[e.split]}.png`,t.className="species-move-sprite",t}function Xe(e){const t=re.typeT[e.types[0]].toLowerCase(),n=document.createElement("div");return n.innerText=e.name,n.className=`species-move-name ${t}-t`,n}function Ze(e){const t=document.createElement("div");return t.className="species-move-row",t.onclick=function(t){fastdom.mutate((()=>{s(function(e){const t=()=>{we(2),Ye()},n=re.moves[e],s=be("div","move-overlay"),i=be("div","move-overlay-power"),a=be("div","move-overlay-top",n.name);a.onclick=t=>{o(t),function(e){mt.callbackAfterFilters=()=>{$("#moves-list").children().eq(e-1).click()[0].scrollIntoView({behavior:"smooth"})},$("#btn-moves").click()}(e)},Oe(0,a,"Move",void 0);const r=be("div","move-overlay-fill",n.pwr||"?"),l=be("div","move-overlay-stats"),d=be("div","move-overlay-acc",`Acc: ${n.acc||"--"}`),p=be("div","move-overlay-pp",`PP: ${n.pp}`),u=be("div","move-overlay-prio",`Prio: ${n.prio}`),f=be("div","move-overlay-chance",`Chance: ${n.chance}`),m=be("div","move-overlay-other"),v=be("div","move-overlay-types"),g=re.typeT[n.types[0]],h=be("div",`move-overlay-type ${g.toLowerCase()}`,g);Oe(2,h,"type",void 0,t);const y=n.types[1]?re.typeT[n.types[1]]:"",b=be("div",`move-overlay-type ${y.toLowerCase()}`,y);Oe(2,b,"type",void 0,t);const k=be("div"),E=be("img","move-overlay-img pixelated");E.src=`./icons/${re.splitT[n.split]}.png`,Oe(2,k,"category",(()=>re.splitT[n.split].toLowerCase()||""),t);const S=be("div","move-overlay-effects");return c(n.flags.map((e=>re.flagsT[e])),$(S),t),$e([s,[i,[a,r],l,[d,p,u,f],m,[v,[h,b],k,[E]],S]])}(e),t)}))},t}function et(e,t){e.empty();const s=document.createDocumentFragment();var o;o=t,t=n?o.map((e=>-1!=n.indexOf(e)&&e)).filter((e=>e)):o;for(const e of t){const t=re.moves[e];if(!t){console.warn(`unable to find move with ID ${e}`);continue}const n=Ze(e);n.append(Qe(t)),n.append(Xe(t)),s.append(n)}e.append(s)}function tt(e){return`./sprites/${e=e.replace(/^SPECIES_/,"")}.png`}function nt(e){return`./sprites/SHINY_${e=e.replace(/^SPECIES_/,"")}.png`}function st(e,t,n,s){s&&!isNaN(+s)?(e.find(".stat-num").html(`${s}→<br>${t}`),e.find(".stat-num").css("font-size","0.5em").css("width","3em")):(e.find(".stat-num").text(t),e.find(".stat-num").css("font-size","1em").css("width",""));let o="gray";for(const e of[[re.speciesStats.result.min5[n],"#ff3300"],[re.speciesStats.result.min20[n],"#cc6600"],[re.speciesStats.result.median[n],"#cccc00"],[re.speciesStats.result.top20[n],"#99cc00"],[re.speciesStats.result.top5[n],"#33cc33"],[256,"#0033cc"]]){if(t<e[0])break;o=e[1]}const i=(t/(n<6?255:re.speciesStats.result.maxBST)*100).toFixed();e.find(".stat-num").css("background-color",o),e.find(".stat-bar").css("background",`linear-gradient(to right, ${o} ${i}%, #0000 0%)`)[0],e[0].animate([{width:"0"},{width:"100%"}],{duration:300,iterations:1})}function ot(e,t){return function(e){for(const t of e){const e=qe[re.abilities[t].name];if(e)return re.typeT.indexOf(e)}}([t.stats.abis[e],...t.stats.inns])}function it(){[["#switch-moves","#species-moves"],["#switch-evos-locs","#species-evos-locs"],["#switch-misc","#species-misc"]].forEach((e=>{$(e[0]).on("click",(()=>{$(e[0]).parent().find(".sel-active").addClass("sel-n-active").removeClass("sel-active"),$(e[0]).addClass("sel-active").removeClass("sel-n-active"),$("#species-bot").find(".active-sub-panel").removeClass("active-sub-panel").hide(),$(e[1]).addClass("active-sub-panel").show()}))})),$("#species-basestats, #species-coverage").on("click",(function(){$("#species-basestats, #species-coverage").toggle()})),$("#species-types").children().each(((e,t)=>{Oe(0,t,"type")})),$("#species-id, #species-name").on("click",(function(){$("#species-id, #species-name").toggle()}))}function at(e){return(e=e.toLowerCase()).charAt(0).toUpperCase()+e.slice(1)}function ct(e){return e.replace("ITEM_","").split("_").map(at).join(" ")}function rt(e){return e.replace("MOVE_","").split("_").map(at).join(" ")}function lt(e){return e.replace("MAPSEC_","").split("_").map(at).join(" ")}function dt(e){const t=$("<span/>").addClass("specie-block").click((()=>{ze(e)})),n=re.species[e],s=$("<img/>").attr("src",tt(n.NAME)).addClass("sprite"),o=$("<span/>").html(n.name);return t.append(s).append(o)[0]}function pt(e,t){return{EVO_LEVEL:`Evolves at level: ${t}`,EVO_MEGA_EVOLUTION:`Mega-evolves with ${ct(t)}`,EVO_ITEM:`Evolves with ${ct(t)}`,EVO_MOVE:`Evolves with ${rt(t)}`,EVO_LEVEL_ATK_LT_DEF:"Evolves if Atk < def",EVO_LEVEL_ATK_GT_DEF:"Evolves if Atk > def",EVO_LEVEL_ATK_EQ_DEF:"Evolves if Atk = def",EVO_LEVEL_SILCOON:"???",EVO_LEVEL_CASCOON:"???",EVO_PRIMAL_REVERSION:"???",EVO_ITEM_MALE:`Evolves with ${ct(t)}`,EVO_ITEM_FEMALE:`Evolves with ${ct(t)}`,EVO_LEVEL_NINJASK:"???",EVO_LEVEL_SHEDINJA:"???",EVO_MOVE_MEGA_EVOLUTION:`Mega-evolves with ${rt(t)}`,EVO_LEVEL_FEMALE:`Evolves at level: ${t} if female`,EVO_LEVEL_MALE:`Evolves at level: ${t} if male`,EVO_SPECIFIC_MON_IN_PARTY:`Evolves if ${n=t,n.replace("SPECIES_","").split("_").map(at).join(" ")} is in party`,EVO_LEVEL_NIGHT:`Evolves at night if level ${t}`,EVO_LEVEL_DUSK:`Evolves at dusk if level ${t}`,EVO_LEVEL_DAY:`Evolves at day if level ${t}`,EVO_SPECIFIC_MAPSEC:`Evolves when level up at ${lt(t)}`}[re.evoKindT[e]];var n}const ut={name:(e,t)=>{if(he(e,t.name.toLowerCase()))return t.name},type:(e,t)=>{const n=t.stats.types.map((e=>re.typeT[e].toLowerCase()));for(const t of n)if(he(e,t))return t;return!1},ability:(e,t)=>{let n=t.stats.abis.map((e=>re.abilities[e].name.toLowerCase())).concat(t.stats.inns.map((e=>re.abilities[e].name.toLowerCase())));for(const t of n)if(he(e,t))return[t===e,t,!1];return!1},move:(e,t)=>{let n=t.allMoves?.map((e=>re.moves[e].name.toLowerCase()))||[],s=!1;for(const t of n)if(he(e,t)){if(e===t)return[!0,t,!1];s=t}return s},region:(e,t)=>{if(he(e,t.region?.toLowerCase()||""))return t.region}},ft={name:(e,t)=>{const n=t.desc.toLowerCase(),s=t.name.toLowerCase();return!(!he(e,s)&&!he(e,n))&&[s===e||n===e,s,!0]},ability:(e,t)=>{const n=t.desc.toLowerCase(),s=t.name.toLowerCase();return!(!he(e,s)&&!he(e,n))&&[s===e||n===e,n,!0]}},mt={searchData:new Array(5).fill(""),searchKeys:new Array(5).fill(""),updateGuard:!1,updateQueue:!1,searchIsActive:!0,panelUpdatesTable:[function(e){const t=re.species,n=$("#species-list").children(),s=Te(e,t,ut);let o;const i=t.length;for(let e=0;e<i;e++){if(0==e)continue;const t=n.eq(e);s&&-1==s.indexOf(e)?t.hide():(o||(o=e),t.show())}s&&-1==s.indexOf(je)&&o&&Ke(o)},function(e){const t=re.abilities,n=$("#abis-list").children(),s=Te(e,t,ft);let o=0;const i=t.length;for(let e=0;e<i;e++){const t=n.eq(e-1);s&&-1==s.indexOf(e)?t.hide():(t.children().eq(0)[0].className="abi-name color"+(o%2?"A":"B"),t.children().eq(1)[0].className="abi-desc color"+(o%2?"C":"D"),o++,t.show())}},function(e){const t=re.moves,s=$("#moves-list").children();let o;n=Te(e,t,l);const c=t.length;for(let e=0;e<c;e++){if(0==e)continue;const t=s.eq(e-1);n&&-1==n.indexOf(e)?t.hide():(o||(o=e),t.show())}n&&-1==n.indexOf(i)&&o&&a(o)},function(e){const t=re.locations.maps,n=$("#locations-list").children(),s=Te(e,t,Be);let o;const i=t.length;for(let e=0;e<i;e++){const t=n.eq(e);s&&-1==s.indexOf(e)?t.hide():(o||(o=e),t.show())}s&&-1==s.indexOf(Pe)&&o&&_e(o)},function(e){const t=re.trainers,n=$("#trainers-list > .btn");let s;const o=Te(e,t,W),i=t.length;for(let e=0;e<i;e++){if(0==e)continue;const t=n.eq(e-1);o&&-1==o.indexOf(e)?t.hide():(s||(s=e),t.show())}o&&-1==o.indexOf(B)&&s&&G(s)}],queryMapList:[ut,ft,l,Be,W],panelFrozenUpdate:[!1,!1,!1,!1,!1],panelUpdatesIndex:0,queryKeys:["Name","Type","Ability","Move","Move-effect","category","specie","map","region"],operators:["AND","OR","XOR"],defrosting:!0,callbackAfterFilters:null,timeoutAutoComplete:null,maxSuggestion:5,suggestions:[],suggestionNode:null,suggestionInput:null,suggestionSaved:"",suggestionData:"",suggestionPreviousNode:null,addSuggestion:function(e){this.suggestions.length!=this.maxSuggestion&&(this.suggestions.includes(e)||this.suggestionInput.value!==e&&this.suggestions.push(e))},clearSuggestion:function(){this.suggestionNode&&$(this.suggestionNode).empty(),this.suggestions=[],this.suggestionNode&&(this.suggestionNode.dataset.suggestion=null)},showSuggestion:function(){if(this.suggestionNode){if(!this.searchIsActive)return this.searchIsActive=!0,void this.suggestionInput.blur();1==this.suggestions.length&&this.clearSuggestion(),this.suggestionNode.innerText="";for(const e of this.suggestions){const t=document.createElement("div");t.innerText=e,t.onclick=()=>{this.suggestionInput.value=e,this.searchIsActive=!1,xe()},this.suggestionNode.style.display="block",this.suggestionNode.append(t)}}},defrostFuturePanel:function(){mt.panelFrozenUpdate=mt.panelFrozenUpdate.map(((e,t)=>mt.panelUpdatesIndex!=t))}};function vt(e,t,n,s){mt.suggestionNode=t,mt.suggestionInput=n,n.setAttribute("value",n.value),t.style.display="block",mt.timeoutAutoComplete&&clearTimeout(mt.timeoutAutoComplete),mt.timeoutAutoComplete=setTimeout((()=>{t.style.display="none"}),3e3),gt[e.key]&&gt[e.key]()||s()}const gt={Enter:()=>{mt.suggestionNode.style.display="none",mt.suggestionData&&(mt.suggestionInput.value=mt.suggestionData)},ArrowUp:()=>{let e=+mt.suggestionNode.dataset.suggestion;isNaN(e)&&(e=0);const t=(e||mt.maxSuggestion)-1,n=mt.suggestions[t];if(n&&mt.suggestionNode.children.length>t){mt.suggestionData=n,mt.suggestionPreviousNode&&(mt.suggestionPreviousNode.className="");const e=mt.suggestionNode.children[t];e.className="filter-option-selected",mt.suggestionNode.dataset.suggestion=t,mt.suggestionPreviousNode=e}return!0},ArrowDown:()=>{let e=+mt.suggestionNode.dataset.suggestion;isNaN(e)&&(e=mt.maxSuggestion-1);const t=(e+1)%mt.maxSuggestion,n=mt.suggestions[t];if(n&&mt.suggestionNode.children.length>t){mt.suggestionData=n,mt.suggestionPreviousNode&&(mt.suggestionPreviousNode.className="");const e=mt.suggestionNode.children[t];e.className="filter-option-selected",mt.suggestionNode.dataset.suggestion=t,mt.suggestionPreviousNode=e}return!0},ArrowRight:()=>{const e=mt.suggestions[mt.suggestionNode.dataset.suggestion];e&&(mt.suggestionInput.value=e)},ArrowLeft:()=>{mt.suggestionNode.dataset.suggestion="0",mt.suggestionInput.value=mt.suggestionSaved}};function ht(){$("#search-keys").on("change",xe),$("#search-bar").on("keyup search",(e=>{vt(e,$("#search-suggestion")[0],$("#search-bar")[0],(()=>{xe((()=>{ye(mt.suggestionNode),mt.suggestionSaved=mt.suggestionInput.value}))}))})),$("#filter-icon").on("click",(function(){$("#filter-frame").toggle()})),$("#search-keys").on("click",(function(e){e.stopPropagation(),ye($("#search-keys-selections")[0],$("#search-keys")[0]),$("#search-keys-selections").toggle()})),$("#to-filter")[0].onclick=()=>{const e=$("#search-bar").val();e&&(Ce(mt.panelUpdatesIndex,$("#search-keys").val(),e),$("#search-bar").val(""),Me())};for(const e of mt.operators){const t=document.createElement("option");t.value=e,t.innerText=e,$("#filter-main-operator").append(t)}const e=$("#search-keys-selections");for(const t of mt.queryKeys){const n=document.createElement("div");n.innerText=t,n.onclick=()=>{$("#search-keys").val(t),$("#search-keys-selections").toggle(),xe()},e.append(n)}yt(mt.queryMapList[mt.panelUpdatesIndex])}function yt(e){const t=$("#search-keys-selections").children();let n=null;mt.queryKeys.forEach(((s,o)=>{s=s.toLowerCase(),e[s]?(null===n&&(n=o),t.eq(o).show()):t.eq(o).hide()})),n&&$("#search-keys").val(t.eq(n).text())}const bt=function(){const e=[["#btn-species","#panel-species","#species-data","#builder-data"],["#btn-abis","#panel-abis"],["#btn-moves","#panel-moves"],["#btn-locations","#panel-locations"],["#btn-trainers","#panel-trainers"]];for(const t in e){const n=e[t];$(n[0]).on("click",(()=>{const e=$("aside .btn-active"),s=$(n[0]),o=$(n[1]);if(e[0]===s[0]){if(!n[2])return;const e=s.find(".small-select"),t=s.find(".big-select");return e[0].className="big-select",t[0].className="small-select",e.insertBefore(t),$(n[2]).toggle(),void $(n[3]).toggle()}e.addClass("btn-n-active"),e.removeClass("btn-active"),s.removeClass("btn-n-active"),s.addClass("btn-active");const i=$(".active-panel");i.removeClass("active-panel"),i.toggle(),o.addClass("active-panel"),o.toggle(),mt.panelUpdatesIndex=t,mt.panelFrozenUpdate[t]?(mt.defrosting=!1,fastdom.mutate((()=>{xe(),mt.panelFrozenUpdate[t]=!1,yt(mt.queryMapList[t]),mt.defrosting=!0}))):mt.callbackAfterFilters&&(mt.callbackAfterFilters(),mt.callbackAfterFilters=null),$("#search-bar").val(mt.searchData[mt.panelUpdatesIndex]),yt(mt.queryMapList[t]),$("#search-keys").val(mt.searchKeys[mt.panelUpdatesIndex]||ge(Object.keys(mt.queryMapList[t])[0]))})),$(n[1]).toggle()}const t=$(e[0][1]);t.addClass("active-panel"),t.toggle()},$t={interval:0,audio:!1},kt=["boink","spinnySkirt","spinnySkirt","texxxt"];function Et(){if(clearInterval($t.interval),!$t.audio){$t.audio=!0;var e=new Audio("./js/data/playInsanity.webm");const t=function(){e.play()};e.addEventListener("ended",t),e.play()}const t=$("body").find("*"),n=t.length;$t.interval=setInterval((()=>{const e=Math.floor(Math.random()*n),s=`\n            --random0: ${Math.round(10*Math.random())+3}s;\n            --random1: ${Math.round(360*Math.random())}deg;\n            --random2: ${Math.round(360*Math.random())}deg;\n            --random3: ${(1*Math.random()).toPrecision(2)}em;\n            --random4: ${(3*Math.random()).toPrecision(2)}em;\n        `;document.documentElement.style.cssText=s;const o=t.eq(e),i=kt[Math.floor(Math.random()*kt.length)];o.addClass(i)}),100)}document.addEventListener("DOMContentLoaded",(function(){z((()=>{}),"start");const e=[[b,"settings"],[bt,"side bar"],[r,"panel moves"],[it,"panel species"],[T,"panel builder"],[ht,"search frame"],[Fe,"filter frame"],[me,"gamedata loader"],[function(){fe(h("lastusedvqersion"),!0)},"loading gamedata"]];for(const t of e)z(t[0],t[1]);!function(){let e,t=!0,n=!1;$(document).on("touchstart",(t=>{e=t.originalEvent.changedTouches[0].clientY})),$(document).on("touchend",(s=>{const o=s.originalEvent.changedTouches[0].clientY-e;if(n=!0,0!=o){if(o<0){if(2*o<-document.body.clientHeight){if(!t)return;t=!1}}else{if(!(2*o>document.body.clientHeight))return;if(t)return;t=!0}t?$("#top-header, #search-wrapper").show():$("#top-header, #search-wrapper").hide()}}))}(),ve($(".main-title")[0],"Berkay, the dex is up btw"),$("#insanity").on("click",Et)}))})();